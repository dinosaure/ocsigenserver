OASISFormat:		0.4
Name:			ocsigenserver
Version:		0.1
Synopsis:		HTTP Server in OCaml
Authors:		Vincent Balat
License:		MIT
Plugins:		META (0.3), DevFiles (0.3)
BuildTools:		ocamlbuild
OCamlVersion:		>= 4.01
BetaFeatures:		section_object

Library ocsigenserver
  Path:			src/
  Pack:			true

Flag commandline
  Description:		Parse command line
  Default:		true

Library polytables
  Path:			src/polytables
  FindlibParent:	ocsigenserver
  Modules:		Polytables

Library commandline
  Path:			src/commandline/yes
  FindlibParent:	ocsigenserver
  Modules:		Ocsigen_getcommandline
  Build$:		flag(commandline)


Library nocommandline
  Path:			src/commandline/no
  FindlibParent:	ocsigenserver
  Modules:		Ocsigen_getcommandline
  Build$:		!flag(commandline)

Library baselib
  Path:			src/baselib
  FindlibParent:	ocsigenserver
  Modules:		Ocsigen_cache,
                        Ocsigen_commandline,
                        Ocsigen_config,
                        Ocsigen_lib,
                        Ocsigen_lib_base,
                        Ocsigen_loader,
                        Ocsigen_messages,
                        Ocsigen_stream,
                        Dynlink_wrapper
  BuildDepends:		lwt,
                        netstring,
                        netstring-pcre,
                        cryptokit,
                        findlib,
                        tyxml,
                        lwt.syntax,
                        lwt.extra,
                        ipaddr,
                        threads,
                        dynlink,
                        optcomp

# Executable test_wrapping
#   Path:			src/baselib/tests
#   MainIs:		test_wrapping.ml
#   Build$:		flag(tests)
#   CompiledObject:	best
#   Install:		false
#   BuildDepends:		ocsigenserver.baselib
#
#
# Test "test_wrapping"
#   Run$:			flag(tests)
#   TestTools:		test_wrapping
#   Command:		$test_wrapping
#   WorkingDirectory:	src/baselib/tests

Library http
  Path:			src/http
  FindlibParent:	ocsigenserver
  Modules:		Ocsigen_cookies,
                        Ocsigen_http_frame,
                        Ocsigen_headers,
                        Ocsigen_http_com,
                        Ocsigen_charset_mime,
                        Ocsigen_senders
  InternalModules:	Multipart,
                        Http_lexer,
                        Http_headers,
                        Framepp
  BuildDepends:		ocsigenserver.baselib,
                        netstring,
                        netstring-pcre,
                        lwt.ssl,
                        tyxml

Library server
  Path:			src/server
  FindlibParent:	ocsigenserver
  Modules:		Ocsigen_extensions,
                        Ocsigen_range,
                        Ocsigen_parseconfig,
                        Ocsigen_http_client,
                        Ocsigen_local_files,
                        Ocsigen_server
  BuildDepends:		ocsigenserver.baselib,
                        ocsigenserver.polytables,
                        ocsigenserver.http,
                        lwt.unix,
                        netstring,
                        netstring-pcre,
                        cryptokit,
                        findlib,
                        tyxml,
                        tyxml.parser,
                        lwt.syntax,
                        lwt.extra,
                        ipaddr,
                        threads

# EXTENSIONS

Library extensions
  Path:			src/extensions/
  FindlibParent:	ocsigenserver

Library staticmod
  Path:			src/extensions
  Modules:		Staticmod
  FindlibParent:	extensions
  BuildDepends:		ocsigenserver,
                        ocsigenserver.baselib,
                        ocsigenserver.server,
                        lwt

Library accesscontrol
  Path:			src/extensions
  Modules:		Accesscontrol
  FindlibParent:	extensions
  BuildDepends:		netstring-pcre,
                        ocsigenserver,
                        ocsigenserver.baselib,
                        ocsigenserver.server,
                        lwt

Library authbasic
  Path:			src/extensions
  Modules:		Authbasic
  FindlibParent:	extensions
  BuildDepends:		netstring-pcre,
                        ocsigenserver,
                        ocsigenserver.baselib,
                        ocsigenserver.server,
                        lwt

Library cgimod
  Path:			src/extensions
  Modules:		Cgimod
  FindlibParent:	extensions
  BuildDepends:		netstring-pcre,
                        ocsigenserver,
                        ocsigenserver.baselib,
                        ocsigenserver.server,
                        lwt

Library cors
  Path:			src/extensions
  Modules:		Cors
  FindlibParent:	extensions
  BuildDepends:		netstring-pcre,
                        ocsigenserver,
                        ocsigenserver.baselib,
                        ocsigenserver.server,
                        lwt

Library deflatemod
  Path:			src/extensions
  Modules:		Deflatemod
  FindlibParent:	extensions
  BuildDepends:		netstring-pcre,
                        camlzip,
                        ocsigenserver,
                        ocsigenserver.baselib,
                        ocsigenserver.server,
                        lwt

Library extendconfiguration
  Path:			src/extensions
  Modules:		Extendconfiguration
  FindlibParent:	extensions
  BuildDepends:		netstring-pcre,
                        ocsigenserver,
                        ocsigenserver.baselib,
                        ocsigenserver.server,
                        lwt

Library extensiontemplate
  Path:			src/extensions
  Modules:		Extensiontemplate
  FindlibParent:	extensions
  BuildDepends:		netstring-pcre,
                        ocsigenserver,
                        ocsigenserver.baselib,
                        ocsigenserver.server,
                        lwt

Library ocsigen_comet
  Path:			src/extensions
  Modules:		Ocsigen_comet
  FindlibParent:	extensions
  BuildDepends:		netstring-pcre,
                        react,
                        ocsigenserver,
                        ocsigenserver.baselib,
                        ocsigenserver.server,
                        lwt

Library outputfilter
  Path:			src/extensions
  Modules:		Outputfilter
  FindlibParent:	extensions
  BuildDepends:		netstring-pcre,
                        ocsigenserver,
                        ocsigenserver.baselib,
                        ocsigenserver.server,
                        lwt

Library redirectmod
  Path:			src/extensions
  Modules:		Redirectmod
  FindlibParent:	extensions
  BuildDepends:		netstring-pcre,
                        ocsigenserver,
                        ocsigenserver.baselib,
                        ocsigenserver.server,
                        lwt

Library revproxy
  Path:			src/extensions
  Modules:		Revproxy
  FindlibParent:	extensions
  BuildDepends:		netstring-pcre,
                        ocsigenserver,
                        ocsigenserver.baselib,
                        ocsigenserver.server,
                        lwt

Library rewritemod
  Path:			src/extensions
  Modules:		Rewritemod
  FindlibParent:	extensions
  BuildDepends:		netstring-pcre,
                        ocsigenserver,
                        ocsigenserver.baselib,
                        ocsigenserver.server,
                        lwt

Library userconf
  Path:			src/extensions
  Modules:		Userconf
  FindlibParent:	extensions
  BuildDepends:		netstring-pcre,
                        ocsigenserver,
                        ocsigenserver.baselib,
                        ocsigenserver.server,
                        lwt

Executable ocsigenserver
  Path:			bin/
  MainIs:		server_main.ml
  CompiledObject:	native
  BuildDepends:		lwt,
                        ocsigenserver.baselib,
                        ocsigenserver.polytables,
                        ocsigenserver.http,
                        ocsigenserver.server
